{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{241:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),l=M(a(13)),o=a(1),s=M(o),i=a(25),u=M(a(0)),d=M(a(292)),c=M(a(267)),f=a(14),p=a(91),m=M(a(53));a(291);var h=a(12),b=M(h),g=a(52),y=M(a(90)),v=M(a(271)),w=M(a(553)),O=a(88),k=M(O);function M(e){return e&&e.__esModule?e:{default:e}}function S(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var E=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.dataFetched=!1,a.state={data:[],selectedStocklist:null,availableStocklists:[],productInfo:null,users:[],isLoading:!0},a.addItem=a.addItem.bind(a),a.editItem=a.editItem.bind(a),a.updateItemField=a.updateItemField.bind(a),a.saveItem=a.saveItem.bind(a),a.deleteItem=a.deleteItem.bind(a),a}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),r(t,[{key:\"componentDidMount\",value:function(){this.props.fetchTranslations(\"\",\"stockListManagement\"),this.props.stockListManagementTranslationsFetched&&(this.dataFetched=!0,this.fetchData(),this.fetchAvailableStocklists(),this.fetchProductInfo(),this.fetchUsers())}},{key:\"componentWillReceiveProps\",value:function(e){this.props.locale&&this.props.locale!==e.locale&&this.props.fetchTranslations(e.locale,\"stockListManagement\"),e.stockListManagementTranslationsFetched&&!this.dataFetched&&(this.dataFetched=!0,this.fetchData(),this.fetchAvailableStocklists(),this.fetchProductInfo(),this.fetchUsers())}},{key:\"fetchUsers\",value:function(){var e=this;this.props.showSpinner();b.default.get(\"//api/generic/person\").then(function(t){var a=l.default.map(t.data.data,function(e){return{value:{id:e.id,email:e.email,label:e.name},label:e.name}});e.setState({users:a}),e.props.hideSpinner()}).catch(function(){return e.props.hideSpinner()})}},{key:\"fetchData\",value:function(){var e=this;this.props.showSpinner();var t=\"//api/stocklistItems?product.id=\"+(this.props.match.params.productId||\"\");b.default.get(t).then(function(t){e.setState({data:(0,h.parseResponse)(t.data.data),isLoading:!1})}).catch(this.props.hideSpinner())}},{key:\"fetchAvailableStocklists\",value:function(){var e=this;this.props.showSpinner();b.default.get(\"//api/stocklistItems/availableStocklists\").then(function(t){e.setState({availableStocklists:l.default.map((0,h.parseResponse)(t.data.data),function(e){return{value:e,label:e.name}})})}).catch(this.props.hideSpinner())}},{key:\"fetchProductInfo\",value:function(){var e=this;this.props.showSpinner();var t=\"//api/products/\"+this.props.match.params.productId+\"/withCatalogs\";b.default.get(t).then(function(t){e.setState({productInfo:t.data.data})}).catch(this.props.hideSpinner())}},{key:\"addItem\",value:function(e){this.setState({selectedStocklist:null,data:(0,c.default)(this.state.data,{$push:[{stocklistId:e.id,name:e.name,location:{id:e.location.id,name:e.location.name},locationGroup:{id:e.locationGroup.id,name:e.locationGroup.name},manager:{id:e.manager.id,name:e.manager.name},replenishmentPeriod:e.replenishmentPeriod,maxQuantity:null,new:!0}]})})}},{key:\"editItem\",value:function(e){this.setState({data:(0,c.default)(this.state.data,S({},e,{edit:{$set:!0}}))})}},{key:\"updateItemField\",value:function(e,t,a){this.setState({data:(0,c.default)(this.state.data,S({},e,S({},t,{$set:a})))})}},{key:\"saveItem\",value:function(e,t){var a=this,n=\"//api/stocklistItems?product.id=\"+(this.props.match.params.productId||\"\");t.new||(n=\"//api/stocklistItems/\"+t.requisitionItem.id),b.default.post(n,(0,h.flattenRequest)(t)).then(function(t){a.setState({data:(0,c.default)(a.state.data,S({},e,{$set:(0,h.parseResponse)(t.data.data)}))})}).catch(this.props.hideSpinner())}},{key:\"deleteItem\",value:function(e){var t=this,a=this.state.data[e];if(a.new)this.removeItem(e);else{this.props.showSpinner();var n=\"//api/stocklistItems/\"+a.requisitionItem.id;b.default.delete(n).then(function(){t.removeItem(e)}).catch(this.props.hideSpinner())}}},{key:\"removeItem\",value:function(e){this.setState({data:(0,c.default)(this.state.data,{$splice:[[e,1]]})})}},{key:\"render\",value:function(){var e=this,t=this.state.data;return s.default.createElement(\"div\",{className:\"main-container\"},this.state.productInfo&&s.default.createElement(\"div\",{className:\"mb-2\"},s.default.createElement(\"div\",{className:\"d-flex flex-row justify-content-between\"},s.default.createElement(\"div\",{className:\"d-flex flex-row align-items-end\"},s.default.createElement(\"h6\",{className:\"mb-0 mr-1\"},this.state.productInfo.productCode),s.default.createElement(\"h5\",{className:\"mb-0\"},this.state.productInfo.name)),s.default.createElement(\"div\",{className:\"align-self-center\"},s.default.createElement(\"button\",{className:\"btn btn-outline-primary btn-xs\",onClick:function(){window.location=\"//inventoryItem/showStockCard/\"+e.state.productInfo.id}},s.default.createElement(k.default,{id:\"react.stockListManagement.returnStockCard.label\",defaultMessage:\"Return to stock card\"})))),s.default.createElement(\"div\",{className:\"d-flex flex-row\"},l.default.map(this.state.productInfo.catalogs,function(e){return s.default.createElement(\"div\",{key:e.id,className:\"stocklist-category px-1 mr-1\"},e.name)}))),s.default.createElement(d.default,{data:t,pivotBy:[\"locationGroup.name\",\"location.name\"],showPagination:!1,minRows:0,sortable:!1,noDataText:this.state.isLoading?\"Loading...\":\"No rows found\",style:{maxHeight:this.state.productInfo&&l.default.some(this.state.productInfo.catalogs,function(e){return!l.default.isEmpty(e)})?\"calc(100vh - 275px)\":\"calc(100vh - 250px)\"},collapseOnDataChange:!1,defaultSorted:[{id:\"locationGroup.name\"}],resolveData:function(e){return e.map(function(e){return l.default.get(e,\"locationGroup.name\")?e:n({},e,{locationGroup:{name:\"No location group\"}})})},columns:[{Header:s.default.createElement(p.Tooltip,{title:this.props.translate(\"react.stockListManagement.locationGroup.label\",\"Location Group Name\"),theme:\"transparent\",delay:\"150\",duration:\"250\",hideDelay:\"50\"},s.default.createElement(k.default,{id:\"react.stockListManagement.locationGroup.label\",defaultMessage:\"Location Group Name\"})),accessor:\"locationGroup.name\",className:\"w-space-normal\"},{Header:s.default.createElement(p.Tooltip,{title:this.props.translate(\"react.stockListManagement.locationName.label\",\"Location Name\"),theme:\"transparent\",delay:\"150\",duration:\"250\",hideDelay:\"50\"},s.default.createElement(k.default,{id:\"react.stockListManagement.locationName.label\",defaultMessage:\"Location Name\"})),accessor:\"location.name\",aggregate:function(){return\"\"},className:\"w-space-normal\"},{Header:s.default.createElement(p.Tooltip,{title:this.props.translate(\"react.stockListManagement.stockListName.label\",\"Stocklist Name\"),theme:\"transparent\",delay:\"150\",duration:\"250\",hideDelay:\"50\"},s.default.createElement(k.default,{id:\"react.stockListManagement.stockListName.label\",defaultMessage:\"Stocklist Name\"})),accessor:\"name\",aggregate:function(){return\"\"},Cell:function(e){var t=e.aggregated,a=e.original;return t?\"\":s.default.createElement(\"a\",{href:\"//requisitionTemplate/show/\"+a.stocklistId},s.default.createElement(p.Tooltip,{title:a.name,theme:\"transparent\",delay:\"150\",duration:\"250\",hideDelay:\"50\"},a.name))}},{Header:s.default.createElement(p.Tooltip,{title:this.props.translate(\"react.stockListManagement.monthlyStockListQty.label\",\"Monthly Stocklist Qty\"),theme:\"transparent\",delay:\"150\",duration:\"250\",hideDelay:\"50\"},s.default.createElement(k.default,{id:\"react.stockListManagement.monthlyStockListQty.label\",defaultMessage:\"Monthly Stocklist Qty\"})),accessor:\"monthlyDemand\",aggregate:function(e){return l.default.sum(e)},className:\"text-center\",Cell:function(e){var t=e.aggregated,a=e.original;return t?\"\":s.default.createElement(p.Tooltip,{title:a.monthlyDemand,theme:\"transparent\",delay:\"150\",duration:\"250\",hideDelay:\"50\"},a.monthlyDemand)}},{Header:s.default.createElement(p.Tooltip,{title:this.props.translate(\"react.stockListManagement.manager.label\",\"Manager\"),theme:\"transparent\",delay:\"150\",duration:\"250\",hideDelay:\"50\"},s.default.createElement(k.default,{id:\"react.stockListManagement.manager.label\",defaultMessage:\"Manager\"})),accessor:\"manager.name\",aggregate:function(){return\"\"},Cell:function(e){var t=e.aggregated,a=e.original;return t?\"\":s.default.createElement(p.Tooltip,{title:a.manager.name,theme:\"transparent\",delay:\"150\",duration:\"250\",hideDelay:\"50\"},a.manager.name)}},{Header:s.default.createElement(p.Tooltip,{title:this.props.translate(\"react.stockListManagement.replenishmentPeriod.label\",\"Replenishment period\"),theme:\"transparent\",delay:\"150\",duration:\"250\",hideDelay:\"50\"},s.default.createElement(k.default,{id:\"react.stockListManagement.replenishmentPeriod.label\",defaultMessage:\"Replenishment period\"})),accessor:\"replenishmentPeriod\",aggregate:function(){return\"\"},className:\"text-center\",Cell:function(e){var t=e.aggregated,a=e.original;return t?\"\":s.default.createElement(p.Tooltip,{title:a.replenishmentPeriod,theme:\"transparent\",delay:\"150\",duration:\"250\",hideDelay:\"50\"},a.replenishmentPeriod)}},{Header:s.default.createElement(p.Tooltip,{title:this.props.translate(\"react.stockListManagement.replenishmentQty.label\",\"Replenishment Qty\"),theme:\"transparent\",delay:\"150\",duration:\"250\",hideDelay:\"50\"},s.default.createElement(k.default,{id:\"react.stockListManagement.replenishmentQty.label\",defaultMessage:\"Replenishment Qty\"})),accessor:\"maxQuantity\",aggregate:function(e){return l.default.sum(e)},className:\"text-center\",Cell:function(t){var a=t.aggregated,n=t.index,r=t.original;return a?\"\":r.new||r.edit?s.default.createElement(\"div\",{className:l.default.isNil(r.maxQuantity)||\"\"===r.maxQuantity?\"has-error\":\"\"},s.default.createElement(p.Tooltip,{title:r.maxQuantity,theme:\"transparent\",delay:\"150\",duration:\"250\",hideDelay:\"50\"},s.default.createElement(v.default,{value:r.maxQuantity||\"\",onChange:function(t){return e.updateItemField(n,\"maxQuantity\",t)}}))):l.default.isNil(r.maxQuantity)?\"\":r.maxQuantity}},{Header:s.default.createElement(p.Tooltip,{title:this.props.translate(\"react.stockListManagement.uom.label\",\"Unit of measure\"),theme:\"transparent\",delay:\"150\",duration:\"250\",hideDelay:\"50\"},s.default.createElement(k.default,{id:\"react.stockListManagement.uom.label\",defaultMessage:\"Unit of measure\"})),accessor:\"uom\",aggregate:function(){return\"\"},className:\"text-center\",Cell:function(e){var t=e.aggregated,a=e.original;return t?\"\":s.default.createElement(p.Tooltip,{title:a.uom,theme:\"transparent\",delay:\"150\",duration:\"250\",hideDelay:\"50\"},a.uom)}},{Header:s.default.createElement(p.Tooltip,{title:this.props.translate(\"react.stockListManagement.actions.label\",\"Actions\"),theme:\"transparent\",delay:\"150\",duration:\"250\",hideDelay:\"50\"},s.default.createElement(k.default,{id:\"react.stockListManagement.actions.label\",defaultMessage:\"Actions\"})),accessor:\"edit\",minWidth:230,className:\"text-center\",aggregate:function(){return\"\"},Cell:function(t){var a=t.aggregated,n=t.index,r=t.original;return a?\"\":s.default.createElement(\"div\",{className:\"d-flex flex-wrap\"},e.props.isUserAdmin?s.default.createElement(\"div\",null,s.default.createElement(\"button\",{className:\"btn btn-outline-primary btn-xs mr-1\",disabled:r.edit||r.new||!e.props.isUserAdmin,onClick:function(){return e.editItem(n)}},s.default.createElement(k.default,{id:\"react.default.button.edit.label\",defaultMessage:\"Edit\"})),s.default.createElement(\"button\",{className:\"btn btn-outline-primary btn-xs mr-1\",disabled:!r.edit&&!r.new||!r.stocklistId||l.default.isNil(r.maxQuantity)||\"\"===r.maxQuantity||!e.props.isUserAdmin,onClick:function(){return e.saveItem(n,r)}},s.default.createElement(k.default,{id:\"react.default.button.save.label\",defaultMessage:\"Save\"})),s.default.createElement(\"button\",{className:\"btn btn-outline-danger btn-xs mr-1\",disabled:!e.props.isUserAdmin,onClick:function(){return e.deleteItem(n)}},s.default.createElement(k.default,{id:\"react.default.button.delete.label\",defaultMessage:\"Delete\"}))):null,s.default.createElement(\"a\",{className:\"btn btn-outline-secondary btn-xs mr-1\",disabled:r.edit||r.new,href:\"//stocklist/renderPdf/\"+r.stocklistId},s.default.createElement(k.default,{id:\"react.default.button.printPdf.label\",defaultMessage:\"Print PDF\"})),s.default.createElement(\"a\",{className:\"btn btn-outline-secondary btn-xs mr-1\",disabled:r.edit||r.new,href:\"//stocklist/generateCsv/\"+r.stocklistId},s.default.createElement(k.default,{id:\"react.default.button.printCsv.label\",defaultMessage:\"Print XLS\"})),r.manager?s.default.createElement(w.default,{stocklistId:r.stocklistId,users:e.state.users,manager:r.manager}):s.default.createElement(\"button\",{className:\"btn btn-outline-secondary btn-xs mr-1\",onClick:function(){return m.default.error(e.props.translate(\"react.stockListManagement.alert.noManagerAssociated.label\",\"There is no manager associated with this stock list. Please add a manager and try again.\"))}},s.default.createElement(k.default,{id:\"react.default.button.email.label\",defaultMessage:\"Email\"})))}}]}),this.props.isUserAdmin?s.default.createElement(\"div\",{className:\"d-flex flex-row my-1\"},s.default.createElement(y.default,{value:this.state.selectedStocklist,onChange:function(t){return e.setState({selectedStocklist:t})},options:this.state.availableStocklists,objectValue:!0,className:\"select-xs stocklist-select\"}),s.default.createElement(\"button\",{className:\"btn btn-outline-success btn-xs ml-1\",disabled:!this.state.selectedStocklist,onClick:function(){e.addItem(e.state.selectedStocklist)}},s.default.createElement(k.default,{id:\"react.stockListManagement.addStockList.label\",defaultMessage:\"Add stocklist\"}))):null)}}]),t}();t.default=(0,i.connect)(function(e){return{translate:(0,O.translateWithDefaultMessage)((0,f.getTranslate)(e.localize)),locale:e.session.activeLanguage,stockListManagementTranslationsFetched:e.session.fetchedTranslations.stockListManagement,isUserAdmin:e.session.isUserAdmin}},{showSpinner:g.showSpinner,hideSpinner:g.hideSpinner,fetchTranslations:g.fetchTranslations})(E),E.propTypes={match:u.default.shape({params:u.default.shape({productId:u.default.string})}).isRequired,showSpinner:u.default.func.isRequired,hideSpinner:u.default.func.isRequired,translate:u.default.func.isRequired,locale:u.default.string.isRequired,stockListManagementTranslationsFetched:u.default.bool.isRequired,fetchTranslations:u.default.func.isRequired,isUserAdmin:u.default.bool.isRequired}},250:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.renderField=t.renderFormFields=t.renderFormField=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r=c(a(1)),l=a(91),o=c(a(0)),s=a(14),i=a(25);a(93);var u=a(88),d=c(u);function c(e){return e&&e.__esModule?e:{default:e}}t.renderFormField=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=e.type;return r.default.createElement(l,n({key:t,fieldName:t,fieldConfig:e},a))};var f=function(e){var t=e.renderInput,a=e.attributes,o=a.required,s=a.hidden,i=function(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}(a,[\"required\",\"hidden\"]),u=e.label,c=e.defaultMessage,f=e.touched,p=e.arrayField,m=e.input,h=e.translate,b=e.meta,g=b.touched,y=b.error,v=n({id:m.name},i),w=\"form-group mb-0 \"+(o?\"required\":\"\")+\" \"+(s?\"d-none\":\"\")+\" \"+((g||f)&&y?\"has-error\":\"\");return p?r.default.createElement(l.Tooltip,{title:h(\"\"+y),disabled:!y||!(g||f),theme:\"transparent\",arrow:\"true\",delay:\"150\",duration:\"250\",hideDelay:\"50\"},r.default.createElement(\"div\",{className:w},t(m,v))):r.default.createElement(\"div\",{className:\"mt-2 \"+w},r.default.createElement(\"div\",{className:\"row\"},\"string\"==typeof u?r.default.createElement(\"label\",{htmlFor:v.id,className:\"col-md-2 col-7 col-form-label col-form-label-xs text-center text-md-right\"},u&&r.default.createElement(d.default,{id:u,defaultMessage:c})):r.default.createElement(u,null),r.default.createElement(\"div\",{className:\"col-md-4 col-7\"},t(m,v))),r.default.createElement(\"div\",{className:\"row\"},r.default.createElement(\"div\",{className:\"col-md-2\"}),r.default.createElement(\"div\",{className:\"help-block col-md-4\",style:{float:\"left\"}},y&&g||y&&f?h(\"\"+y):\"\")))};t.renderFormFields=f;t.renderField=(0,i.connect)(function(e){return{translate:(0,u.translateWithDefaultMessage)((0,s.getTranslate)(e.localize))}})(f);f.propTypes={renderInput:o.default.func.isRequired,attributes:o.default.shape({}).isRequired,label:o.default.oneOfType([o.default.string,o.default.func]),defaultMessage:o.default.string,touched:o.default.bool,arrayField:o.default.bool,input:o.default.shape({}).isRequired,meta:o.default.shape({}).isRequired,translate:o.default.func.isRequired},f.defaultProps={touched:!1,arrayField:!1,label:\"\",defaultMessage:\"\"}},254:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r=s(a(1)),l=s(a(262)),o=s(a(271));function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){return r.default.createElement(l.default,n({},e,{renderInput:function(e){return r.default.createElement(o.default,e)}}))}},255:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r=s(a(1)),l=s(a(262)),o=s(a(90));function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){return r.default.createElement(l.default,n({},e,{renderInput:function(e){var t=e.className,a=function(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}(e,[\"className\"]);return r.default.createElement(o.default,n({name:a.id},a,{className:\"select-xs \"+t}))}}))}},262:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),l=c(a(13)),o=a(1),s=c(o),i=c(a(0)),u=a(253),d=a(250);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={touched:!1},a.renderInput=a.renderInput.bind(a),a}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),r(t,[{key:\"shouldComponentUpdate\",value:function(e,t){return this.state.touched!==t.touched||!l.default.isEqualWith(this.props,e,function(e,t){if(\"function\"==typeof e||\"function\"==typeof t)return!0})}},{key:\"renderInput\",value:function(e,t){var a=this,r=n({},t,{value:e.value,onChange:function(a){t.onChange&&t.onChange(a),e.onChange(a)},onBlur:function(e){t.onBlur&&t.onBlur(e),a.setState({touched:!0})}});return this.props.renderInput(r)}},{key:\"render\",value:function(){var e=this.props,t=e.fieldName,a=e.fieldConfig,r=a.label,l=a.defaultMessage,o=a.getDynamicAttr,i=a.attributes,c=void 0===i?{}:i,f=e.arrayField,p=e.fieldValue,m=e.fieldRef,h=e.focusThis,b=e.arrowsNavigation,g=function(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}(e,[\"fieldName\",\"fieldConfig\",\"arrayField\",\"fieldValue\",\"fieldRef\",\"focusThis\",\"arrowsNavigation\"]),y=o?o(n({},g,{fieldValue:p})):{},v=n({},c,y,{fieldRef:m});if(b){var w=v.focusLeft||g.focusLeft,O=v.focusRight||g.focusRight,k=v.arrowLeft?v.arrowLeft:function(){return!!w&&(g.focusField(g.rowIndex,w),!0)},M=v.arrowRight?v.arrowRight:function(){return!!O&&(g.focusField(g.rowIndex,O),!0)},S=v.arrowUp?v.arrowUp:function(){return g.rowIndex>0&&(g.focusField(g.rowIndex-1,h),!0)},E=v.arrowDown?v.arrowDown:function(){return g.rowIndex<g.rowCount-1&&(g.focusField(g.rowIndex+1,h),!0)};v=n({},v,{arrowLeft:k,arrowRight:M,arrowUp:S,arrowDown:E})}return s.default.createElement(u.Field,{name:t,component:d.renderField,renderInput:this.renderInput,attributes:v,label:r,defaultMessage:l,touched:this.state.touched,arrayField:f})}}]),t}();t.default=f,f.propTypes={fieldName:i.default.string.isRequired,fieldConfig:i.default.shape({getDynamicAttr:i.default.func}).isRequired,renderInput:i.default.func.isRequired,arrayField:i.default.bool,fieldValue:i.default.oneOfType([i.default.string,i.default.shape({}),i.default.any]),fieldRef:i.default.func,focusThis:i.default.string,arrowsNavigation:i.default.bool},f.defaultProps={arrayField:!1,fieldValue:void 0,fieldRef:null,focusThis:null,arrowsNavigation:!1}},271:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r=o(a(1)),l=o(a(0));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(e){var t=e.fieldRef,a=e.onChange,l=e.className,o=void 0===l?\"\":l,s=e.arrowLeft,i=e.arrowUp,u=e.arrowRight,d=e.arrowDown,c=e.onTabPress,f=function(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}(e,[\"fieldRef\",\"onChange\",\"className\",\"arrowLeft\",\"arrowUp\",\"arrowRight\",\"arrowDown\",\"onTabPress\"]);return r.default.createElement(\"input\",n({type:\"text\",ref:t,onKeyPress:function(e){13===e.which&&e.preventDefault()},onKeyDown:function(e){switch(e.keyCode){case 37:s&&(s(),e.preventDefault());break;case 38:i&&(i(),e.preventDefault());break;case 39:u&&(u(),e.preventDefault());break;case 40:d&&(d(),e.preventDefault());break;case 9:c&&c(e)}},className:\"form-control form-control-xs \"+o},f,{onChange:function(e){var t=e.target.value;a&&a(t)}}))};t.default=s,s.propTypes={onChange:l.default.func,className:l.default.string,arrowLeft:l.default.func,arrowUp:l.default.func,arrowRight:l.default.func,arrowDown:l.default.func,fieldRef:l.default.func,onTabPress:l.default.func},s.defaultProps={onChange:null,className:\"\",arrowLeft:null,arrowUp:null,arrowRight:null,arrowDown:null,fieldRef:null,onTabPress:null}},274:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),l=a(1),o=m(l),s=m(a(0)),i=m(a(96)),u=a(253),d=m(a(264)),c=m(a(13)),f=a(250),p=m(a(88));function m(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={showModal:!1},a.openModal=a.openModal.bind(a),a.closeModal=a.closeModal.bind(a),a.save=a.save.bind(a),a}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.Component),r(t,[{key:\"openModal\",value:function(){this.props.onOpen(),this.setState({showModal:!0})}},{key:\"closeModal\",value:function(){this.props.onClose(),this.setState({showModal:!1})}},{key:\"save\",value:function(e){this.props.onSave(e),this.setState({showModal:!1})}},{key:\"render\",value:function(){var e=this,t=this.props.title;return o.default.createElement(\"div\",null,o.default.createElement(\"button\",{type:\"button\",className:\"btn-xs \"+this.props.btnOpenClassName,style:this.props.btnOpenStyle,disabled:this.props.btnOpenDisabled,onClick:function(){return e.openModal()}},o.default.createElement(p.default,{id:this.props.btnOpenText,defaultMessage:this.props.btnOpenDefaultText})),o.default.createElement(i.default,{isOpen:this.props.showModal||this.state.showModal,onRequestClose:this.closeModal,className:\"modal-content-custom\",shouldCloseOnOverlayClick:!1},o.default.createElement(\"div\",{className:this.props.bodyContainerClassName,style:this.props.bodyContainerStyle},\"string\"==typeof t?o.default.createElement(\"h5\",{className:\"text-center\"},\" \",o.default.createElement(p.default,{id:t})):o.default.createElement(t,null),o.default.createElement(\"hr\",null),o.default.createElement(u.Form,{onSubmit:function(t){return e.save(t)},initialValues:this.props.initialValues,validate:this.props.validate,mutators:n({},d.default),render:function(t){var a=t.handleSubmit,n=t.values;return o.default.createElement(\"form\",{id:\"modalForm\",onSubmit:a},e.props.children,e.props.renderBodyWithValues(n),c.default.map(e.props.fields,function(t,a){return(0,f.renderFormField)(t,a,e.props.formProps)}),o.default.createElement(\"hr\",null),o.default.createElement(\"div\",{className:e.props.btnContainerClassName,role:\"group\",style:e.props.btnContainerStyle},o.default.createElement(\"button\",{type:\"submit\",className:e.props.btnSaveClassName,style:e.props.btnSaveStyle,disabled:e.props.btnSaveDisabled},o.default.createElement(p.default,{id:e.props.btnSaveText,defaultMessage:e.props.btnSaveDefaultText})),o.default.createElement(\"button\",{type:\"button\",className:e.props.btnCancelClassName,style:e.props.btnCancelStyle,onClick:function(){return e.closeModal()}},o.default.createElement(p.default,{id:e.props.btnCancelText,defaultMessage:e.props.btnCancelDefaultText}))))}}))))}}]),t}();t.default=h,h.propTypes={btnOpenText:s.default.string,btnOpenDefaultText:s.default.string,btnOpenClassName:s.default.string,btnOpenStyle:s.default.shape({}),btnOpenDisabled:s.default.bool,title:s.default.oneOfType([s.default.string,s.default.func]).isRequired,children:s.default.element,bodyContainerClassName:s.default.string,bodyContainerStyle:s.default.shape({}),btnContainerClassName:s.default.string,btnContainerStyle:s.default.shape({}),btnSaveText:s.default.string,btnSaveDefaultText:s.default.string,btnSaveClassName:s.default.string,btnSaveStyle:s.default.shape({}),btnSaveDisabled:s.default.bool,btnCancelText:s.default.string,btnCancelDefaultText:s.default.string,btnCancelClassName:s.default.string,btnCancelStyle:s.default.shape({}),onOpen:s.default.func,onSave:s.default.func,onClose:s.default.func,validate:s.default.func,renderBodyWithValues:s.default.func,initialValues:s.default.oneOfType([s.default.shape({}),s.default.arrayOf(s.default.shape({}))]),fields:s.default.shape({}),formProps:s.default.shape({}),showModal:s.default.bool},h.defaultProps={btnOpenText:\"react.default.button.open.label\",btnOpenDefaultText:\"Open\",btnOpenClassName:\"btn btn-outline-primary\",btnOpenStyle:{},btnOpenDisabled:!1,children:null,bodyContainerClassName:\"modal-body-container\",bodyContainerStyle:{},btnContainerClassName:\"btn-group float-right\",btnContainerStyle:{},btnSaveText:\"react.default.button.save.label\",btnSaveDefaultText:\"Save\",btnSaveClassName:\"btn btn-outline-success\",btnSaveStyle:{},btnSaveDisabled:!1,btnCancelText:\"react.default.button.cancel.label\",btnCancelDefaultText:\"Cancel\",btnCancelClassName:\"btn btn-outline-secondary\",btnCancelStyle:{},onOpen:function(){return null},onSave:function(){return null},onClose:function(){return null},validate:function(){return null},renderBodyWithValues:function(){return null},initialValues:[],fields:{},formProps:{},showModal:!1}},290:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r=o(a(1)),l=o(a(0));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(e){var t=e.value,a=e.indeterminate,l=e.custom,o=e.fieldRef,s=function(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}(e,[\"value\",\"indeterminate\",\"custom\",\"fieldRef\"]),i=function(e){var t=e.target.checked;s.onChange&&s.onChange(t)};return l?r.default.createElement(\"div\",{className:\"custom-checkbox\"},r.default.createElement(\"input\",n({type:\"checkbox\",ref:o,checked:t},s,{onChange:i})),r.default.createElement(\"label\",{htmlFor:s.id})):r.default.createElement(\"input\",n({type:\"checkbox\",ref:function(e){e&&(e.indeterminate=a),o&&o(e)},checked:t},s,{onChange:i}))};t.default=s,s.propTypes={onChange:l.default.func,value:l.default.bool,indeterminate:l.default.bool,custom:l.default.bool,id:l.default.string,fieldRef:l.default.func},s.defaultProps={onChange:null,value:null,indeterminate:!1,custom:!1,id:\"\",fieldRef:void 0}},314:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r=s(a(1)),l=s(a(262)),o=s(a(290));function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){return r.default.createElement(l.default,n({},e,{renderInput:function(e){var t=e.value,a=function(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}(e,[\"value\"]);return r.default.createElement(o.default,n({},a,{value:t||!1}))}}))}},553:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),l=w(a(13)),o=a(1),s=w(o),i=w(a(0)),u=a(25),d=w(a(53)),c=a(14),f=w(a(274)),p=w(a(254)),m=w(a(554)),h=w(a(255)),b=w(a(12)),g=a(52),y=a(88),v=w(a(314));function w(e){return e&&e.__esModule?e:{default:e}}var O={recipients:{type:h.default,label:\"react.stockListManagement.recipients.label\",defaultMessage:\"Recipients\",attributes:{required:!0,showValueTooltip:!0,multi:!0,objectValue:!0,style:{paddingBottom:5}},getDynamicAttr:function(e){return{options:e.users}}},subject:{type:p.default,label:\"react.stockListManagement.subject.label\",defaultMessage:\"Subject\",attributes:{required:!0}},text:{type:m.default,label:\"react.stockListManagement.message.label\",defaultMessage:\"Message\",attributes:{rows:8,required:!0}},includePdf:{type:v.default,label:\"react.stockListManagement.includePdf.label\",defaultMessage:\"Include PDF document\"},includeXls:{type:v.default,label:\"react.stockListManagement.includeXls.label\",defaultMessage:\"Include XLS document\"}};function k(e){var t={};return l.default.isEmpty(e.recipients)&&(t.recipients=\"react.default.error.requiredField.label\"),e.subject||(t.subject=\"react.default.error.requiredField.label\"),e.text||(t.text=\"react.default.error.requiredField.label\"),t}var M=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={formValues:{},showModal:!1},a.onOpen=a.onOpen.bind(a),a.onSave=a.onSave.bind(a),a.onClose=a.onClose.bind(a),a}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),r(t,[{key:\"onOpen\",value:function(){var e=this.props.manager;this.setState({formValues:{subject:\"STOCK LIST UPDATE\",text:\"Please find attached a new version of your stock list reflecting recent updates. Please use this version for your next replenishment request.\",recipients:e?[{id:e.id,email:e.email,label:e.name}]:[],includePdf:!0,includeXls:!0,showModal:!0}})}},{key:\"onSave\",value:function(e){var t=this;this.props.showSpinner();var a=\"//api/stocklists/sendMail/\"+this.props.stocklistId+\"?includePdf=\"+this.state.formValues.includePdf+\"?includeXls=\"+this.state.formValues.includeXls,r=n({},e,{recipients:l.default.map(l.default.filter(e.recipients,function(e){return e.email}),function(e){return e.email})}),o=this.props.manager;l.default.some(e.recipients,function(e){return e.email===o.email})?b.default.post(a,r).then(function(){t.props.hideSpinner(),t.setState({showModal:!1}),d.default.success(t.props.translate(\"react.stockListManagement.alert.emailSend.label\",\"Email sent successfully\"),{timeout:1e3})}).catch(function(){return t.props.hideSpinner()}):(this.props.hideSpinner(),d.default.error(this.props.translate(\"react.stockListManagement.alert.noManagerSelected.label\",\"Please add a manager as a recipient and resend.\"),{timeout:1e3}),this.setState({showModal:!0}))}},{key:\"onClose\",value:function(){this.setState({showModal:!1})}},{key:\"render\",value:function(){return s.default.createElement(f.default,{title:\"react.stockListManagement.sendMailModalTitle.label\",btnOpenText:\"react.default.button.email.label\",btnOpenDefaultText:\"Email\",btnSaveText:\"react.default.button.send.label\",btnSaveDefaultText:\"Send\",btnOpenClassName:\"btn btn-outline-secondary btn-xs mr-1\",onOpen:this.onOpen,onSave:this.onSave,onClose:this.onClose,fields:O,initialValues:this.state.formValues,formProps:{users:this.props.users},validate:k,showModal:this.state.showModal})}}]),t}();t.default=(0,u.connect)(function(e){return{translate:(0,y.translateWithDefaultMessage)((0,c.getTranslate)(e.localize))}},{showSpinner:g.showSpinner,hideSpinner:g.hideSpinner})(M),M.propTypes={showSpinner:i.default.func.isRequired,hideSpinner:i.default.func.isRequired,stocklistId:i.default.string.isRequired,users:i.default.arrayOf(i.default.shape({})),manager:i.default.shape({}),translate:i.default.func.isRequired},M.defaultProps={users:[],manager:null}},554:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r=s(a(1)),l=s(a(262)),o=s(a(555));function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){return r.default.createElement(l.default,n({},e,{renderInput:function(e){return r.default.createElement(o.default,e)}}))}},555:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r=o(a(1)),l=o(a(0));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(e){var t=e.onChange,a=e.className,l=void 0===a?\"\":a,o=e.fieldRef,s=function(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}(e,[\"onChange\",\"className\",\"fieldRef\"]);return r.default.createElement(\"textarea\",n({ref:o,onKeyPress:function(e){13===e.which&&e.preventDefault()},className:\"form-control form-control-xs \"+l},s,{onChange:function(e){var a=e.target.value;t&&t(a)}}))};t.default=s,s.propTypes={onChange:l.default.func,className:l.default.string,fieldRef:l.default.func},s.defaultProps={onChange:null,className:\"\",fieldRef:null}}}]);","extractedComments":[]}