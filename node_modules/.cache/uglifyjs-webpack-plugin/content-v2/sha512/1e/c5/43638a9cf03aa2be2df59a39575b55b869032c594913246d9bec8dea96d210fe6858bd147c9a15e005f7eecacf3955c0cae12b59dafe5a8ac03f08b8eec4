{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{239:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},i=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),l=E(a(13)),r=a(1),u=E(r),o=a(25),s=E(a(0)),c=a(253),d=E(a(264)),f=E(a(243)),p=a(89),m=a(14);a(256);var b=E(a(545)),h=E(a(547)),v=a(12),g=E(v),y=a(52),R=a(88);function E(e){return e&&e.__esModule?e:{default:e}}function x(e){var t={containers:[]};if(e.dateDelivered){var a=(0,f.default)(e.dateDelivered,\"MM/DD/YYYY HH:mm Z\");(0,f.default)().diff(a)<0&&(t.dateDelivered=\"react.partialReceiving.error.futureDate.label\");var n=e.dateShipped?(0,f.default)(e.dateShipped,\"MM/DD/YYYY HH:mm Z\"):null;n&&a<n&&(t.dateDelivered=\"react.partialReceiving.error.dateBeforeShipment.label\")}else t.dateDelivered=\"react.default.error.requiredField.label\";return l.default.forEach(e.containers,function(e,a){t.containers[a]={shipmentItems:[]},l.default.forEach(e.shipmentItems,function(e,n){e.quantityReceiving<0&&(t.containers[a].shipmentItems[n]={quantityReceiving:\"react.partialReceiving.error.quantityToReceiveNegative.label\"})})}),t}var S=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.dataFetched=!1,a.state={page:0,bins:[],formData:{},completed:!1,locationId:\"\",shipmentNumber:\"\"},a.nextPage=a.nextPage.bind(a),a.prevPage=a.prevPage.bind(a),a.save=a.save.bind(a),a.saveAndExit=a.saveAndExit.bind(a),a.confirmReceive=a.confirmReceive.bind(a),a}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),i(t,[{key:\"componentDidMount\",value:function(){this.props.fetchTranslations(\"\",\"partialReceiving\"),this.props.partialReceivingTranslationsFetched&&(this.dataFetched=!0,this.fetchPartialReceiptCandidates())}},{key:\"componentWillReceiveProps\",value:function(e){this.props.locale&&this.props.locale!==e.locale&&this.props.fetchTranslations(e.locale,\"partialReceiving\"),e.partialReceivingTranslationsFetched&&!this.dataFetched&&(this.dataFetched=!0,this.fetchPartialReceiptCandidates())}},{key:\"onSubmit\",value:function(e){var t=this;if(0===this.state.page){var a=l.default.map(e.containers,function(e){return n({},e,{shipmentItems:l.default.chain(e.shipmentItems).map(function(e){return e.receiptItemId?n({},e,{quantityReceiving:e.quantityReceiving?e.quantityReceiving:0}):e}).filter(function(e){return!l.default.isNil(e.quantityReceiving)&&\"\"!==e.quantityReceiving}).value()})}),i=n({},e,{receiptStatus:\"CHECKING\",containers:l.default.filter(a,function(e){return e.shipmentItems.length})});this.save(i,this.nextPage)}else{!!l.default.some(e.containers,function(e){return l.default.some(e.shipmentItems,function(e){return l.default.isNull(e.binLocation.id)})})&&this.props.hasBinLocationSupport&&\"RECEIVED\"!==e.shipmentStatus?this.confirmReceive(e):this.save(n({},e,{receiptStatus:\"COMPLETED\"}),function(){t.setState({completed:!0});var a=e.requisition;window.location=\"//stockMovement/show/\"+a})}}},{key:\"getFormList\",value:function(e){return[u.default.createElement(b.default,n({},e,{bins:this.state.bins,save:this.save,saveAndExit:this.saveAndExit})),u.default.createElement(h.default,n({},e,{prevPage:this.prevPage,save:this.save,saveAndExit:this.saveAndExit,completed:this.state.completed}))]}},{key:\"confirmReceive\",value:function(e){var t=this;(0,p.confirmAlert)({title:this.props.translate(\"react.partialReceiving.message.confirmReceive.label\",\"Confirm receiving\"),message:this.props.translate(\"react.partialReceiving.confirmReceive.message\",\"Are you sure you want to receive? There are some lines with empty bin locations.\"),buttons:[{label:this.props.translate(\"react.default.yes.label\",\"Yes\"),onClick:function(){return t.save(n({},e,{receiptStatus:\"COMPLETED\"}),function(){t.setState({completed:!0});var a=e.requisition;window.location=\"//stockMovement/show/\"+a})}},{label:this.props.translate(\"react.default.no.label\",\"No\")}]})}},{key:\"save\",value:function(e,t){var a=this;this.saveValues(e).then(function(e){a.props.hideSpinner(),a.setState({formData:{}},function(){return a.setState({formData:(0,v.parseResponse)(e.data.data)})}),t&&t()}).catch(function(){return a.props.hideSpinner()})}},{key:\"saveValues\",value:function(e){this.props.showSpinner();var t=\"//api/partialReceiving/\"+this.props.match.params.shipmentId+\"?stepNumber=\"+(this.state.page+1),a=n({},e,{containers:l.default.map(e.containers,function(e){return n({},e,{shipmentItems:l.default.map(e.shipmentItems,function(e){return l.default.get(e,\"recipient.id\")?e:n({},e,{recipient:\"\"})})})})});return g.default.post(t,(0,v.flattenRequest)(a))}},{key:\"saveAndExit\",value:function(e){var t=this;this.saveValues(e).then(function(){var t=e.requisition;window.location=\"//stockMovement/show/\"+t}).catch(function(){return t.props.hideSpinner()})}},{key:\"nextPage\",value:function(){var e=this;this.setState({page:this.state.page+1},function(){return e.fetchPartialReceiptCandidates()})}},{key:\"prevPage\",value:function(){var e=this;this.setState({page:this.state.page-1,completed:!1},function(){return e.fetchPartialReceiptCandidates()})}},{key:\"fetchPartialReceiptCandidates\",value:function(){var e=this;this.props.showSpinner();var t=\"//api/partialReceiving/\"+this.props.match.params.shipmentId+\"?stepNumber=\"+(this.state.page+1);return g.default.get(t).then(function(t){var a=(0,v.parseResponse)(t.data.data);e.setState({formData:{},locationId:a.destination.id,shipmentNumber:a.shipment.shipmentNumber},function(){e.fetchBins(),e.setState({formData:a})})}).catch(function(){return e.props.hideSpinner()})}},{key:\"fetchBins\",value:function(){var e=this,t=\"//api/internalLocations/receiving?location.id=\"+this.state.locationId+\"&shipmentNumber=\"+this.state.shipmentNumber;return g.default.get(t).then(function(t){var a=l.default.map(t.data.data,function(e){return{value:{id:e.id,name:e.name},label:e.name}});e.setState({bins:a},function(){return e.props.hideSpinner()})}).catch(function(){return e.props.hideSpinner()})}},{key:\"render\",value:function(){var e=this,t=this.state,a=t.page,i=t.formData,l=t.locationId;return l?u.default.createElement(c.Form,{onSubmit:function(t){return e.onSubmit(t)},validate:x,mutators:n({},d.default),initialValues:i,render:function(t){var n=t.handleSubmit,i=t.values,r=t.form;return u.default.createElement(\"div\",null,i.shipment&&i.shipment.shipmentNumber&&u.default.createElement(\"h2\",{className:\"my-2 text-center\"},i.shipment.shipmentNumber+\" \"+i.shipment.name),u.default.createElement(\"div\",{className:\"align-self-center\"},u.default.createElement(\"form\",{onSubmit:n},e.getFormList({formValues:i,change:r.change,locationId:l})[a])))}}):null}}]),t}();t.default=(0,o.connect)(function(e){return{translate:(0,R.translateWithDefaultMessage)((0,m.getTranslate)(e.localize)),hasBinLocationSupport:e.session.currentLocation.hasBinLocationSupport,locale:e.session.activeLanguage,partialReceivingTranslationsFetched:e.session.fetchedTranslations.partialReceiving}},{showSpinner:y.showSpinner,hideSpinner:y.hideSpinner,fetchTranslations:y.fetchTranslations})(S),S.propTypes={match:s.default.shape({params:s.default.shape({shipmentId:s.default.string})}).isRequired,showSpinner:s.default.func.isRequired,hideSpinner:s.default.func.isRequired,translate:s.default.func.isRequired,hasBinLocationSupport:s.default.bool.isRequired,locale:s.default.string.isRequired,partialReceivingTranslationsFetched:s.default.bool.isRequired,fetchTranslations:s.default.func.isRequired}},290:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},i=r(a(1)),l=r(a(0));function r(e){return e&&e.__esModule?e:{default:e}}var u=function(e){var t=e.value,a=e.indeterminate,l=e.custom,r=e.fieldRef,u=function(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}(e,[\"value\",\"indeterminate\",\"custom\",\"fieldRef\"]),o=function(e){var t=e.target.checked;u.onChange&&u.onChange(t)};return l?i.default.createElement(\"div\",{className:\"custom-checkbox\"},i.default.createElement(\"input\",n({type:\"checkbox\",ref:r,checked:t},u,{onChange:o})),i.default.createElement(\"label\",{htmlFor:u.id})):i.default.createElement(\"input\",n({type:\"checkbox\",ref:function(e){e&&(e.indeterminate=a),r&&r(e)},checked:t},u,{onChange:o}))};t.default=u,u.propTypes={onChange:l.default.func,value:l.default.bool,indeterminate:l.default.bool,custom:l.default.bool,id:l.default.string,fieldRef:l.default.func},u.defaultProps={onChange:null,value:null,indeterminate:!1,custom:!1,id:\"\",fieldRef:void 0}},314:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},i=u(a(1)),l=u(a(262)),r=u(a(290));function u(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){return i.default.createElement(l.default,n({},e,{renderInput:function(e){var t=e.value,a=function(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}(e,[\"value\"]);return i.default.createElement(r.default,n({},a,{value:t||!1}))}}))}},545:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},i=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),l=M(a(13)),r=a(1),u=M(r),o=a(25),s=M(a(267)),c=M(a(0)),d=M(a(276)),f=M(a(254)),p=M(a(255)),m=M(a(257)),b=M(a(261)),h=M(a(275)),v=M(a(289)),g=a(250),y=M(a(90)),R=M(a(290)),E=a(52),x=M(a(546)),S=M(a(88)),w=a(12),q=M(w);function M(e){return e&&e.__esModule?e:{default:e}}function I(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var N=function(e,t){return e?l.default.toInteger(t.quantityReceived)+l.default.toInteger(t.quantityCanceled)>=l.default.toInteger(t.quantityShipped):!t.shipmentItems||l.default.every(t.shipmentItems,function(e){return l.default.toInteger(e.quantityReceived)>=l.default.toInteger(e.quantityShipped)})},O={\"origin.name\":{type:b.default,label:\"react.partialReceiving.origin.label\",defaultMessage:\"Origin\"},\"destination.name\":{type:b.default,label:\"react.partialReceiving.destination.label\",defaultMessage:\"Destination\"},dateShipped:{type:b.default,label:\"react.partialReceiving.shippedOn.label\",defaultMessage:\"Shipped on\"},dateDelivered:{type:h.default,label:\"react.partialReceiving.deliveredOn.label\",defaultMessage:\"Delivered on\",attributes:{showTimeSelect:!0,dateFormat:\"MM/DD/YYYY HH:mm Z\",autoComplete:\"off\"},getDynamicAttr:function(e){return{disabled:e.shipmentReceived}}},buttonsTop:{type:function(e){var t=e.autofillLines,a=e.onSave,n=e.saveDisabled,i=e.shipmentReceived,l=e.exportTemplate,r=e.importTemplate,o=e.saveAndExit;return u.default.createElement(\"div\",{className:\"mb-1 text-center\"},u.default.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-success mr-3 btn-xs\",disabled:i,onClick:function(){return t()}},u.default.createElement(S.default,{id:\"react.partialReceiving.autofillQuantities.label\",defaultMessage:\"Autofill quantities\"})),u.default.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-success btn-xs mr-3\",disabled:n||i,onClick:function(){return o()}},u.default.createElement(\"span\",null,u.default.createElement(\"i\",{className:\"fa fa-sign-out pr-2\"}),u.default.createElement(S.default,{id:\"react.default.button.saveAndExit.label\",defaultMessage:\"Save and exit\"}))),u.default.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-success btn-xs mr-3\",disabled:n||i,onClick:function(){return a()}},u.default.createElement(S.default,{id:\"react.default.button.save.label\",defaultMessage:\"Save\"})),u.default.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-secondary btn-xs mr-3\",onClick:function(){return l()}},u.default.createElement(\"span\",null,u.default.createElement(\"i\",{className:\"fa fa-upload pr-2\"}),u.default.createElement(S.default,{id:\"react.default.button.exportTemplate.label\",defaultMessage:\"Export template\"}))),u.default.createElement(\"label\",{htmlFor:\"csvInput\",className:\"btn btn-outline-secondary btn-xs mt-2\"},u.default.createElement(\"span\",null,u.default.createElement(\"i\",{className:\"fa fa-download pr-2\"}),u.default.createElement(S.default,{id:\"react.default.button.importTemplate.label\",defaultMessage:\"Import template\"})),u.default.createElement(\"input\",{id:\"csvInput\",type:\"file\",style:{display:\"none\"},onChange:r,onClick:function(e){e.target.value=null},accept:\".csv\"})),u.default.createElement(\"button\",{type:\"submit\",className:\"btn btn-outline-primary float-right btn-form btn-xs\",disabled:n||i},u.default.createElement(S.default,{id:\"react.default.button.next.label\",defaultMessage:\"Next\"})))}},containers:{type:m.default,maxTableHeight:\"none\",rowComponent:v.default,subfieldKey:\"shipmentItems\",getDynamicRowAttr:function(e){var t=e.rowValues,a=e.subfield,n=\"\";return N(a,t)&&(n=\"text-disabled\"),{className:n}},fields:{autofillLine:{fieldKey:\"\",label:\"\",flexWidth:\"0\",type:function(e){var t=e.subfield,a=e.parentIndex,n=e.rowIndex,i=e.autofillLines,r=e.fieldValue,o=e.shipmentReceived;return u.default.createElement(R.default,{disabled:o||N(t,r),className:t?\"ml-4\":\"mr-4\",value:function(e,t){return e?!l.default.isNil(t.quantityReceiving)&&\"\"!==t.quantityReceiving:!!t.shipmentItems&&l.default.every(t.shipmentItems,function(e){return!l.default.isNil(e.quantityReceiving)&&\"\"!==e.quantityReceiving||N(!0,e)})&&l.default.some(t.shipmentItems,function(e){return!l.default.isNil(e.quantityReceiving)&&\"\"!==e.quantityReceiving})}(t,r),indeterminate:function(e,t){return!e&&!!t.shipmentItems&&l.default.some(t.shipmentItems,function(e){return!l.default.isNil(e.quantityReceiving)&&\"\"!==e.quantityReceiving})&&l.default.some(t.shipmentItems,function(e){return(l.default.isNil(e.quantityReceiving)||\"\"===e.quantityReceiving)&&!N(!0,e)})}(t,r),onChange:function(e){t?i(!e,a,n):i(!e,n)}})}},\"parentContainer.name\":{fieldKey:\"\",type:function(e){return e.subfield?null:u.default.createElement(b.default,e)},label:\"react.partialReceiving.pallet.label\",defaultMessage:\"Pallet\",flexWidth:\"0.8\",attributes:{formatValue:function(e){return l.default.get(e,\"parentContainer.name\")||l.default.get(e,\"container.name\")||\"Unpacked\"}}},\"container.name\":{fieldKey:\"\",type:function(e){return e.subfield?null:u.default.createElement(b.default,e)},label:\"react.partialReceiving.box.label\",defaultMessage:\"Box\",flexWidth:\"0.8\",attributes:{formatValue:function(e){return l.default.get(e,\"parentContainer.name\")&&l.default.get(e,\"container.name\")||\"\"}}},\"product.productCode\":{type:function(e){return e.subfield?u.default.createElement(b.default,e):null},label:\"react.partialReceiving.code.label\",defaultMessage:\"Code\",flexWidth:\"0.8\"},\"product.name\":{type:function(e){return e.subfield?u.default.createElement(b.default,e):null},label:\"react.partialReceiving.name.label\",defaultMessage:\"Name\",flexWidth:\"3.3\",attributes:{className:\"text-left ml-1\",showValueTooltip:!0}},lotNumber:{type:function(e){return e.subfield?u.default.createElement(b.default,e):null},label:\"react.partialReceiving.lotSerialNo.label\",defaultMessage:\"Lot/Serial No.\",flexWidth:\"1\"},expirationDate:{type:function(e){return e.subfield?u.default.createElement(b.default,e):null},label:\"react.partialReceiving.expirationDate.label\",defaultMessage:\"Expiration date\",flexWidth:\"1.5\"},binLocation:{type:function(e){return e.subfield?u.default.createElement(p.default,e):u.default.createElement(y.default,{disabled:!e.hasBinLocationSupport||e.shipmentReceived||N(!1,e.fieldValue),options:e.bins,onChange:function(t){return e.setLocation(e.rowIndex,t)},objectValue:!0,className:\"select-xs\"})},fieldKey:\"\",flexWidth:\"1.7\",label:\"react.partialReceiving.binLocation.label\",defaultMessage:\"Bin Location\",getDynamicAttr:function(e){var t=e.bins,a=e.hasBinLocationSupport,n=e.shipmentReceived,i=e.fieldValue;return{options:t,disabled:!a||n||N(!0,i)}},attributes:{objectValue:!0}},\"recipient.id\":{type:function(e){return e.subfield?u.default.createElement(p.default,e):null},fieldKey:\"\",flexWidth:\"1.5\",label:\"react.partialReceiving.recipient.label\",defaultMessage:\"Recipient\",getDynamicAttr:function(e){var t=e.users,a=e.shipmentReceived,n=e.fieldValue;return{options:t,disabled:a||N(!0,n)}}},quantityShipped:{type:function(e){return e.subfield?u.default.createElement(b.default,e):null},label:\"react.partialReceiving.shipped.label\",defaultMessage:\"Shipped\",flexWidth:\"0.8\",attributes:{formatValue:function(e){return e?e.toLocaleString(\"en-US\"):e}}},quantityReceived:{type:function(e){return e.subfield?u.default.createElement(b.default,e):null},label:\"react.partialReceiving.received.label\",defaultMessage:\"Received\",flexWidth:\"0.8\",attributes:{formatValue:function(e){return e?e.toLocaleString(\"en-US\"):\"0\"}}},quantityRemaining:{type:function(e){return e.subfield?u.default.createElement(b.default,e):null},label:\"react.partialReceiving.toReceive.label\",defaultMessage:\"To receive\",flexWidth:\"0.8\",fieldKey:\"\",getDynamicAttr:function(e){var t=e.fieldValue,a=e.shipmentReceived;return{className:l.default.toInteger(t.quantityRemaining)<0&&!a&&!N(!0,t)?\"text-danger\":\"\",formatValue:function(e){return e.quantityRemaining?l.default.toInteger(t.quantityRemaining)<0&&(a||N(!0,t))?\"0\":e.quantityRemaining.toLocaleString(\"en-US\"):e.quantityRemaining}}}},quantityReceiving:{type:function(e){return e.subfield?u.default.createElement(f.default,e):null},fieldKey:\"\",label:\"react.partialReceiving.receivingNow.label\",defaultMessage:\"Receiving now\",flexWidth:\"1\",attributes:{autoComplete:\"off\"},getDynamicAttr:function(e){var t=e.shipmentReceived,a=e.fieldValue;return{disabled:t||N(!0,a)}}},edit:{type:function(e){return e.subfield?u.default.createElement(x.default,e):null},fieldKey:\"\",label:\"\",flexWidth:\"1\",attributes:{btnOpenText:\"react.default.button.edit.label\",btnOpenDefaultText:\"Edit line\",title:\"react.default.button.edit.label\",className:\"btn btn-outline-primary\"},getDynamicAttr:function(e){var t=e.fieldValue;return{fieldValue:t,saveEditLine:e.saveEditLine,parentIndex:e.parentIndex,rowIndex:e.rowIndex,btnOpenDisabled:e.shipmentReceived||N(!0,t)}}},comment:{type:function(e){return e.subfield?u.default.createElement(f.default,e):null},fieldKey:\"\",label:\"react.partialReceiving.comment.label\",defaultMessage:\"Comment\",flexWidth:\"1.3\",attributes:{autoComplete:\"off\"}}}},buttonsBottom:{type:function(e){var t=e.autofillLines,a=e.onSave,n=e.saveDisabled,i=e.shipmentReceived,l=e.exportTemplate,r=e.importTemplate,o=e.saveAndExit;return u.default.createElement(\"div\",{className:\"my-1 text-center\"},u.default.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-success mr-3 btn-xs\",disabled:i,onClick:function(){return t()}},u.default.createElement(S.default,{id:\"react.partialReceiving.autofillQuantities.label\",defaultMessage:\"Autofill quantities\"})),u.default.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-success btn-xs mr-3\",disabled:n||i,onClick:function(){return o()}},u.default.createElement(\"span\",null,u.default.createElement(\"i\",{className:\"fa fa-sign-out pr-2\"}),u.default.createElement(S.default,{id:\"react.default.button.saveAndExit.label\",defaultMessage:\"Save and exit\"}))),u.default.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-success btn-xs mr-3\",disabled:n||i,onClick:function(){return a()}},u.default.createElement(S.default,{id:\"react.default.button.save.label\",defaultMessage:\"Save\"})),u.default.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-secondary btn-xs mr-3\",onClick:function(){return l()}},u.default.createElement(\"span\",null,u.default.createElement(\"i\",{className:\"fa fa-upload pr-2\"}),u.default.createElement(S.default,{id:\"react.default.button.exportTemplate.label\",defaultMessage:\"Export template\"}))),u.default.createElement(\"label\",{htmlFor:\"csvInput\",className:\"btn btn-outline-secondary btn-xs mt-2\"},u.default.createElement(\"span\",null,u.default.createElement(\"i\",{className:\"fa fa-download pr-2\"}),u.default.createElement(S.default,{id:\"react.default.button.importTemplate.label\",defaultMessage:\"Import template\"})),u.default.createElement(\"input\",{id:\"csvInput\",type:\"file\",style:{display:\"none\"},onChange:r,onClick:function(e){e.target.value=null},accept:\".csv\"})),u.default.createElement(\"button\",{type:\"submit\",className:\"btn btn-outline-primary float-right btn-form btn-xs\",disabled:n||i},u.default.createElement(S.default,{id:\"react.default.button.next.label\",defaultMessage:\"Next\"})))}}},C=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.dataFetched=!1,a.autofillLines=a.autofillLines.bind(a),a.setLocation=a.setLocation.bind(a),a.onSave=a.onSave.bind(a),a.onExit=a.onExit.bind(a),a.saveEditLine=a.saveEditLine.bind(a),a.exportTemplate=a.exportTemplate.bind(a),a.importTemplate=a.importTemplate.bind(a),a}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),i(t,null,[{key:\"autofillLine\",value:function(e,t){if(N(!0,t))return t;var a=l.default.toInteger(t.quantityShipped)-l.default.toInteger(t.quantityReceived);return n({},t,{quantityReceiving:e||a<0?null:a})}}]),i(t,[{key:\"componentDidMount\",value:function(){this.props.partialReceivingTranslationsFetched&&!this.props.usersFetched&&(this.dataFetched=!0,this.props.fetchUsers())}},{key:\"componentWillReceiveProps\",value:function(e){!e.partialReceivingTranslationsFetched||this.dataFetched||this.props.usersFetched||(this.dataFetched=!0,this.props.fetchUsers())}},{key:\"onSave\",value:function(){this.props.save(this.props.formValues)}},{key:\"onExit\",value:function(){this.props.saveAndExit(this.props.formValues)}},{key:\"setLocation\",value:function(e,t){if(this.props.formValues.containers&&!l.default.isNil(e)){var a=(0,s.default)(this.props.formValues.containers,I({},e,{shipmentItems:{$apply:function(e){return e?e.map(function(e){return N(!0,e)?e:n({},e,{binLocation:t})}):[]}}}));this.props.change(\"containers\",a)}}},{key:\"autofillLines\",value:function(e,a,n){if(this.props.formValues.containers){var i=[];i=l.default.isNil(a)?(0,s.default)(this.props.formValues.containers,{$apply:function(a){return a?a.map(function(a){return(0,s.default)(a,{shipmentItems:{$apply:function(a){return a?a.map(function(a){return t.autofillLine(e,a)}):[]}}})}):[]}}):l.default.isNil(n)?(0,s.default)(this.props.formValues.containers,I({},a,{shipmentItems:{$apply:function(a){return a?a.map(function(a){return t.autofillLine(e,a)}):[]}}})):(0,s.default)(this.props.formValues.containers,I({},a,{shipmentItems:I({},n,{$apply:function(a){return t.autofillLine(e,a)}})})),this.props.change(\"containers\",i)}}},{key:\"saveEditLine\",value:function(e,t,a){var n=(0,s.default)(this.props.formValues,{containers:I({},t,{shipmentItems:{$splice:[[a,1].concat(function(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}(e))]}})});this.props.save(n)}},{key:\"exportTemplate\",value:function(){var e=this;this.props.showSpinner();var t=this.props.formValues.shipmentId,a=\"//api/partialReceiving/exportCsv/\"+t;q.default.post(a,(0,w.flattenRequest)(this.props.formValues)).then(function(a){(0,d.default)(a.data,\"PartialReceiving\"+(t?\"-\"+t:\"\")+\".csv\",\"text/csv\"),e.props.hideSpinner()}).catch(function(){return e.props.hideSpinner()})}},{key:\"importTemplate\",value:function(e){var t=this;this.props.showSpinner();var a=new FormData,n=e.target.files[0];a.append(\"importFile\",n.slice(0,n.size,\"text/csv\"));var i=\"//api/partialReceiving/importCsv/\"+this.props.formValues.shipmentId;return q.default.post(i,a,{headers:{\"content-type\":\"multipart/form-data\"}}).then(function(){t.props.hideSpinner(),window.location.reload()}).catch(function(){t.props.hideSpinner()})}},{key:\"render\",value:function(){var e=this;return u.default.createElement(\"div\",null,l.default.map(O,function(t,a){return(0,g.renderFormField)(t,a,{autofillLines:e.autofillLines,setLocation:e.setLocation,onSave:e.onSave,saveEditLine:e.saveEditLine,bins:e.props.bins,users:e.props.users,hasBinLocationSupport:e.props.hasBinLocationSupport,locationId:e.props.locationId,saveDisabled:!function(e){return!!l.default.size(e)&&l.default.some(e,function(e){return l.default.size(e.shipmentItems)&&l.default.some(e.shipmentItems,function(e){return!l.default.isNil(e.quantityReceiving)&&\"\"!==e.quantityReceiving})})}(e.props.formValues.containers),shipmentReceived:\"RECEIVED\"===e.props.formValues.shipmentStatus,exportTemplate:e.exportTemplate,importTemplate:e.importTemplate,saveAndExit:e.onExit})}))}}]),t}();t.default=(0,o.connect)(function(e){return{usersFetched:e.users.fetched,users:e.users.data,hasBinLocationSupport:e.session.currentLocation.hasBinLocationSupport,partialReceivingTranslationsFetched:e.session.fetchedTranslations.partialReceiving}},{showSpinner:E.showSpinner,hideSpinner:E.hideSpinner,fetchUsers:E.fetchUsers})(C),C.propTypes={change:c.default.func.isRequired,save:c.default.func.isRequired,saveAndExit:c.default.func.isRequired,showSpinner:c.default.func.isRequired,hideSpinner:c.default.func.isRequired,fetchUsers:c.default.func.isRequired,usersFetched:c.default.bool.isRequired,users:c.default.arrayOf(c.default.shape({})).isRequired,hasBinLocationSupport:c.default.bool.isRequired,formValues:c.default.shape({containers:c.default.arrayOf(c.default.shape({})),shipmentStatus:c.default.string,shipmentId:c.default.string}),bins:c.default.arrayOf(c.default.shape({})),locationId:c.default.string.isRequired,partialReceivingTranslationsFetched:c.default.bool.isRequired},C.defaultProps={formValues:{},bins:[]}},546:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},l=a(1),r=g(l),u=g(a(0)),o=g(a(13)),s=a(25),c=g(a(274)),d=g(a(257)),f=g(a(254)),p=g(a(275)),m=g(a(255)),b=a(52),h=g(a(88)),v=a(92);function g(e){return e&&e.__esModule?e:{default:e}}var y={lines:{type:d.default,addButton:function(e){var t=e.addRow,a=e.shipmentItemId,n=e.binLocation,l=e.product;return r.default.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-success btn-xs\",onClick:function(){return t({shipmentItemId:a,binLocation:n,product:i({},l,{label:l.productCode+\" - \"+l.name}),receiptItemId:null,newLine:!0})}},r.default.createElement(h.default,{id:\"react.default.button.addLine.label\",defaultMessage:\"Add line\"}))},fields:{product:{type:m.default,label:\"react.partialReceiving.product.label\",defaultMessage:\"Product\",fieldKey:\"disabled\",attributes:{className:\"text-left\",async:!0,openOnClick:!1,autoload:!1,filterOptions:function(e){return e},cache:!1,options:[],showValueTooltip:!0},getDynamicAttr:function(e){return{disabled:e.fieldValue,loadOptions:e.debouncedProductsFetch}}},lotNumber:{type:f.default,label:\"react.partialReceiving.lot.label\",defaultMessage:\"Lot\"},expirationDate:{type:p.default,label:\"react.partialReceiving.expiry.label\",defaultMessage:\"Expiry\",attributes:{dateFormat:\"MM/DD/YYYY\",autoComplete:\"off\"}},quantityShipped:{type:f.default,label:\"react.partialReceiving.quantityShipped.label\",defaultMessage:\"Quantity shipped\",attributes:{type:\"number\"}}}}};function R(e){var t={lines:[]};return o.default.forEach(e.lines,function(e,a){e&&o.default.isNil(e.quantityShipped)&&(t.lines[a]={quantityShipped:\"react.partialReceiving.error.enterQuantityShipped.label\"}),e.quantityShipped<0&&(t.lines[a]={quantityShipped:\"react.partialReceiving.error.quantityShippedNegative.label\"})}),t}var E=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=e.fieldConfig,l=n.attributes,r=n.getDynamicAttr,u=r?r(e):{},o=i({},l,u);return a.state={attr:o,formValues:[]},a.onOpen=a.onOpen.bind(a),a.onSave=a.onSave.bind(a),a.debouncedProductsFetch=(0,v.debounceProductsFetch)(a.props.debounceTime,a.props.minSearchLength,a.props.locationId),a}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.Component),n(t,[{key:\"componentWillReceiveProps\",value:function(e){var t=e.fieldConfig,a=t.attributes,n=t.getDynamicAttr,l=n?n(e):{},r=i({},a,l);this.setState({attr:r})}},{key:\"onOpen\",value:function(){this.setState({formValues:{lines:o.default.map([this.state.attr.fieldValue],function(e){return i({},e,{product:i({},e.product,{label:o.default.get(e,\"product.productCode\")+\" - \"+o.default.get(e,\"product.name\")}),disabled:!0,originalLine:!0})})}})}},{key:\"onSave\",value:function(e){this.state.attr.saveEditLine(e.lines,this.state.attr.parentIndex,this.state.attr.rowIndex)}},{key:\"render\",value:function(){return r.default.createElement(c.default,i({},this.state.attr,{onOpen:this.onOpen,onSave:this.onSave,validate:R,initialValues:this.state.formValues,fields:y,formProps:{shipmentItemId:this.state.attr.fieldValue.shipmentItemId,debouncedProductsFetch:this.debouncedProductsFetch,binLocation:this.state.attr.fieldValue.binLocation,product:this.state.attr.fieldValue.product}}))}}]),t}();t.default=(0,s.connect)(function(e){return{debounceTime:e.session.searchConfig.debounceTime,minSearchLength:e.session.searchConfig.minSearchLength}},{showSpinner:b.showSpinner,hideSpinner:b.hideSpinner})(E),E.propTypes={fieldName:u.default.string.isRequired,fieldConfig:u.default.shape({getDynamicAttr:u.default.func}).isRequired,showSpinner:u.default.func.isRequired,hideSpinner:u.default.func.isRequired,rowIndex:u.default.number.isRequired,locationId:u.default.string.isRequired,debounceTime:u.default.number.isRequired,minSearchLength:u.default.number.isRequired}},547:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=m(a(13)),l=a(1),r=m(l),u=m(a(0)),o=m(a(257)),s=m(a(314)),c=m(a(261)),d=m(a(289)),f=a(250),p=m(a(88));function m(e){return e&&e.__esModule?e:{default:e}}var b={\"origin.name\":{type:c.default,label:\"react.partialReceiving.origin.label\",defaultMessage:\"Origin\"},\"destination.name\":{type:c.default,label:\"react.partialReceiving.destination.label\",defaultMessage:\"Destination\"},dateShipped:{type:c.default,label:\"react.partialReceiving.shippedOn.label\",defaultMessage:\"Shipped on\"},dateDelivered:{type:c.default,label:\"react.partialReceiving.deliveredOn.label\",defaultMessage:\"Delivered on\"},buttonsTop:{type:function(e){var t=e.prevPage,a=e.onSave,n=e.saveDisabled,i=e.saveAndExit;return r.default.createElement(\"div\",{className:\"mb-1 text-center\"},r.default.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-primary float-left btn-form btn-xs\",onClick:t},r.default.createElement(p.default,{id:\"react.partialReceiving.backToEdit.label\",defaultMessage:\"Back to edit\"})),r.default.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-success btn-form btn-xs\",onClick:i,disabled:n},r.default.createElement(\"span\",null,r.default.createElement(\"i\",{className:\"fa fa-sign-out pr-2\"}),r.default.createElement(p.default,{id:\"react.default.button.saveAndExit.label\",defaultMessage:\"Save and exit\"}))),r.default.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-success btn-form btn-xs\",onClick:a,disabled:n},r.default.createElement(p.default,{id:\"react.default.button.save.label\",defaultMessage:\"Save\"})),r.default.createElement(\"button\",{type:\"submit\",className:\"btn btn-outline-primary float-right btn-form btn-xs\",disabled:n},r.default.createElement(p.default,{id:\"react.partialReceiving.receiveShipment.label\",defaultMessage:\"Receive shipment\"})))}},containers:{type:o.default,maxTableHeight:\"none\",rowComponent:d.default,subfieldKey:\"shipmentItems\",fields:{\"parentContainer.name\":{fieldKey:\"\",type:function(e){return e.subfield?null:r.default.createElement(c.default,e)},label:\"react.partialReceiving.pallet.label\",defaultMessage:\"Pallet\",flexWidth:\"1\",attributes:{formatValue:function(e){return i.default.get(e,\"parentContainer.name\")||i.default.get(e,\"container.name\")||\"Unpacked\"}}},\"container.name\":{fieldKey:\"\",type:function(e){return e.subfield?null:r.default.createElement(c.default,e)},label:\"react.partialReceiving.box.label\",defaultMessage:\"Box\",flexWidth:\"1\",attributes:{formatValue:function(e){return i.default.get(e,\"parentContainer.name\")&&i.default.get(e,\"container.name\")||\"\"}}},\"product.productCode\":{type:function(e){return e.subfield?r.default.createElement(c.default,e):null},label:\"react.partialReceiving.code.label\",defaultMessage:\"Code\",flexWidth:\"1\"},\"product.name\":{type:function(e){return e.subfield?r.default.createElement(c.default,e):null},label:\"react.partialReceiving.name.label\",defaultMessage:\"Name\",flexWidth:\"4\",attributes:{className:\"text-left ml-1\",showValueTooltip:!0}},lotNumber:{type:function(e){return e.subfield?r.default.createElement(c.default,e):null},label:\"react.partialReceiving.lotSerialNo.label\",defaultMessage:\"Lot/Serial No.\",flexWidth:\"1\"},expirationDate:{type:function(e){return e.subfield?r.default.createElement(c.default,e):null},label:\"react.partialReceiving.expirationDate.label\",defaultMessage:\"Expiration date\",flexWidth:\"1\"},\"binLocation.name\":{type:function(e){return e.subfield?r.default.createElement(c.default,e):null},label:\"react.partialReceiving.binLocation.label\",defaultMessage:\"Bin Location\",flexWidth:\"1.5\"},\"recipient.name\":{type:function(e){return e.subfield?r.default.createElement(c.default,e):null},label:\"react.partialReceiving.recipient.label\",defaultMessage:\"Recipient\",flexWidth:\"1.5\"},quantityReceiving:{type:function(e){return e.subfield?r.default.createElement(c.default,e):null},label:\"react.partialReceiving.receivingNow.label\",defaultMessage:\"Receiving now\",flexWidth:\"1\",attributes:{formatValue:function(e){return e?e.toLocaleString(\"en-US\"):e}}},quantityRemaining:{type:function(e){return e.subfield?r.default.createElement(c.default,e):null},label:\"react.partialReceiving.remaining.label\",defaultMessage:\"Remaining\",flexWidth:\"1\",fieldKey:\"\",attributes:{formatValue:function(e){return e.quantityRemaining?e.quantityRemaining.toLocaleString(\"en-US\"):e.quantityRemaining}},getDynamicAttr:function(e){var t=e.fieldValue;return{className:t.cancelRemaining||!t.quantityRemaining?\"strike-through\":\"text-danger\"}}},cancelRemaining:{fieldKey:\"quantityRemaining\",type:function(e){return e.subfield?r.default.createElement(s.default,e):null},label:\"react.partialReceiving.cancelRemaining.label\",defaultMessage:\"Cancel remaining\",flexWidth:\"1\",getDynamicAttr:function(e){var t=e.saveDisabled,a=e.fieldValue;return{disabled:t||i.default.toInteger(a)<=0}}},comment:{type:function(e){return e.subfield?r.default.createElement(c.default,e):null},label:\"react.partialReceiving.comment.label\",defaultMessage:\"Comment\",flexWidth:\"1\"}}},buttonsBottom:{type:function(e){var t=e.prevPage,a=e.onSave,n=e.saveDisabled,i=e.saveAndExit;return r.default.createElement(\"div\",{className:\"my-1 text-center\"},r.default.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-primary float-left btn-form btn-xs\",onClick:t},r.default.createElement(p.default,{id:\"react.partialReceiving.backToEdit.label\",defaultMessage:\"Back to edit\"})),r.default.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-success btn-form btn-xs\",onClick:i,disabled:n},r.default.createElement(\"span\",null,r.default.createElement(\"i\",{className:\"fa fa-sign-out pr-2\"}),r.default.createElement(p.default,{id:\"react.default.button.saveAndExit.label\",defaultMessage:\"Save and exit\"}))),r.default.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-success btn-form btn-xs\",onClick:a,disabled:n},r.default.createElement(p.default,{id:\"react.default.button.save.label\",defaultMessage:\"Save\"})),r.default.createElement(\"button\",{type:\"submit\",className:\"btn btn-outline-primary float-right btn-form btn-xs\",disabled:n},r.default.createElement(p.default,{id:\"react.partialReceiving.receiveShipment.label\",defaultMessage:\"Receive shipment\"})))}}},h=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.onSave=a.onSave.bind(a),a.onExit=a.onExit.bind(a),a}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.Component),n(t,[{key:\"onSave\",value:function(){this.props.save(this.props.formValues)}},{key:\"onExit\",value:function(){this.props.saveAndExit(this.props.formValues)}},{key:\"render\",value:function(){var e=this;return r.default.createElement(\"div\",null,i.default.map(b,function(t,a){return(0,f.renderFormField)(t,a,{prevPage:e.props.prevPage,onSave:e.onSave,saveDisabled:e.props.completed||!i.default.size(e.props.formValues.containers),saveAndExit:e.onExit})}))}}]),t}();t.default=h,h.propTypes={prevPage:u.default.func.isRequired,save:u.default.func.isRequired,saveAndExit:u.default.func.isRequired,formValues:u.default.shape({containers:u.default.arrayOf(u.default.shape({}))}),completed:u.default.bool},h.defaultProps={formValues:{},completed:!1}}}]);","extractedComments":[]}